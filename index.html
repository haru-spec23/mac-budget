<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>マック◯円以内メーカー（仮）</title>

   <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BDVFGNB90Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-BDVFGNB90Y');
  </script>
  
  <style>
    <style>
  :root{
    --bg:#fff8e1;
    --card:#ffffff;
    --text:#1a1a1a;
    --muted:#555;
    --border:#f0d38a;
    --accent:#d32f2f;   /* マックっぽい赤 */
    --accent2:#f9a825;  /* マックっぽい黄 */
  }

    *{ box-sizing:border-box; }
    body{
    font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
    background: var(--bg);
    color: var(--text);
    margin:0;
  }

    .wrap{
    max-width: 820px;
    margin: 0 auto;
    padding: 18px 14px 40px;
  }

    .topbar{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    padding: 14px 14px;
    border: 1px solid var(--border);
    background: linear-gradient(180deg, #fff, #fff3cf);
    border-radius: 14px;
    box-shadow: 0 8px 22px rgba(0,0,0,0.06);
  }

    h1{
    margin:0;
    font-size: 20px;
    letter-spacing: .2px;
  }

    .links a{
    color: var(--muted);
    text-decoration: none;
    font-size: 14px;
    padding: 8px 10px;
    border-radius: 10px;
    border: 1px solid transparent;
  }
    .links a:hover{
    border-color: var(--border);
    background:#fff;
  }

    .sub{
    margin: 10px 2px 0;
    color: var(--muted);
    font-size: 14px;
  }

    .panel{
    margin-top: 14px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 10px 26px rgba(0,0,0,0.06);
  }

    .row{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
  }

    label{
    font-size: 14px;
    color: var(--muted);
  }

    input, select{
    padding: 10px 12px;
    font-size: 16px;
    border-radius: 12px;
    border: 1px solid #ddd;
    background:#fff;
    outline:none;
    min-height: 42px;
  }
    input:focus, select:focus{
    border-color: var(--accent2);
    box-shadow: 0 0 0 3px rgba(249,168,37,.25);
  }

    button{
  padding: 12px 16px;
  font-size: 16px;
  border-radius: 12px;
  border: 2px solid #b71c1c;
  background: #d32f2f;        /* 濃い赤で固定 */
  color: #ffffff !important;   /* 文字は必ず白 */
  cursor: pointer;
  min-height: 44px;
  font-weight: 800;
  box-shadow: 0 8px 16px rgba(211,47,47,0.25);
}
  button:hover{
  background: #c62828;
}
button:active{
  transform: translateY(1px);
  box-shadow: 0 4px 10px rgba(211,47,47,0.22);
}


    .hint{
    margin-top: 10px;
    font-size: 13px;
    color: var(--muted);
  }

    .result{
    margin-top: 14px;
    border-radius: 14px;
    border: 1px solid var(--border);
    background: #fff;
    padding: 14px;
      border-left: 6px solid var(--accent2);
  background: linear-gradient(180deg, #fff, #fffdf3);

  }

    .sum{
    display:flex;
    align-items:baseline;
    justify-content:space-between;
    gap:10px;
    flex-wrap:wrap;
    padding-bottom: 10px;
    border-bottom: 1px dashed #f0d38a;
    margin-bottom: 10px;
  }

    .sum strong{
    font-size: 18px;
  }

    .badge{
    display:inline-block;
    padding: 6px 10px;
    border-radius: 999px;
    font-size: 12px;
    border: 1px solid var(--border);
    background: #fff7db;
    color:#5a3b00;
  }

    .items{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-top: 10px;
  }

    .item{
    display:flex;
    justify-content:space-between;
    gap:10px;
    padding: 10px 12px;
    border: 1px solid #eee;
    border-radius: 12px;
    background:#fffdf6;
  }

  .item .name{ font-weight: 650; }
  .item .meta{ color: var(--muted); font-size: 13px; white-space: nowrap; }

  @media (max-width:420px){
    .item{ flex-direction:column; }
    .item .meta{ white-space: normal; }
  }
</style>

  </style>
</head>
<body>
 <div class="wrap">

  <div class="topbar">
    <h1>マック予算メーカー</h1>
    <div class="links">
      <a href="./about.html">このサイトについて</a>
    </div>
  </div>

  <p class="sub">
    上限内でランダムに組み合わせを生成します。
  </p>

  <div class="panel">
    <div class="row">
      <label>モード：</label>
      <select id="mode">
        <option value="price">値段（円）</option>
        <option value="cal">カロリー（kcal）</option>
      </select>

      <label>上限：</label>
      <input id="limit" type="number" value="1000" min="0" step="10">

      <button id="btn">生成</button>
    </div>

    <div class="result" id="out">
      ここに結果が出ます
    </div>
  </div>

</div>

  <script>
const items = [
  { name: "チーズバーガー", price: 200, cal: 300 },
  { name: "ポテトS", price: 190, cal: 220 },
  { name: "ナゲット5ピース", price: 260, cal: 270 },
  { name: "コーラS", price: 120, cal: 90 },
  { name: "アイスコーヒーS", price: 120, cal: 5 },
  
  { name: "N.Y. ジューシーチキンホット＆スパイシー", price: 520, cal: 472 },
  { name: "N.Y. ソーセージペッパー＆ビーフテマフィン", price: 490, cal: 468 },
  { name: "N.Y. タルタルシュリンプガーリック＆バジル", price: 540, cal: 460 },
  { name: "N.Y. ダブル肉厚ビーフペッパー＆ビーフ（仮）", price: 740, cal: 622 },
  { name: "N.Y. 肉厚ビーフペッパー＆ビーフ（仮）", price: 620, cal: 454 },

  { name: "えびフィレオ", price: 450, cal: 401 },
  { name: "てりやきチキンフィレオ", price: 460, cal: 496 },
  { name: "てりやきマックバーガー", price: 430, cal: 477 },
  { name: "エグチ（エッグチーズバーガー）", price: 270, cal: 390 },
  { name: "エッグマックマフィン", price: 260, cal: 310 },
  { name: "スパチキ（スパイシーマックチキン）", price: 240, cal: 390 },
  { name: "ソーセージエッグマフィン", price: 340, cal: 477 },
  { name: "ソーセージマフィン", price: 210, cal: 397 },
  { name: "ダブルチーズバーガー", price: 430, cal: 459 },
  { name: "チーズバーガー", price: 220, cal: 310 },
  { name: "チキチー（マックチキン®チーズ）", price: 250, cal: 433 },
  { name: "チキンフィレオ", price: 420, cal: 471 },
  { name: "チキンマックマフィン", price: 200, cal: 372 },
  { name: "ハンバーガー", price: 170, cal: 259 },

  { name: "ビッグマック®", price: 480, cal: 525 },
  { name: "フィレオフィッシュ®", price: 400, cal: 338 },
  { name: "ベーコンエッグマックサンド", price: 330, cal: 294 },
  { name: "ベーコンレタスバーガー", price: 430, cal: 368 },
  { name: "ホットケーキ", price: 360, cal: 323 },
  { name: "ホットケーキシロップ", price: 40, cal: 121 },
  { name: "マックグリドル® ソーセージ", price: 240, cal: 414 },
  { name: "マックグリドル® ソーセージエッグ", price: 330, cal: 545 },
  { name: "マックグリドル® ベーコンエッグ", price: 320, cal: 382 },
  { name: "マックチキン®", price: 200, cal: 383 },
  { name: "メガマフィン", price: 490, cal: 693 },

  { name: "倍えびフィレオ", price: 610, cal: 575 },
  { name: "倍てりやきチキンフィレオ", price: 690, cal: 769 },
  { name: "倍てりやきマックバーガー", price: 620, cal: 731 },
  { name: "倍エグチ", price: 380, cal: 489 },
  { name: "倍スパチキ", price: 340, cal: 550 },
  { name: "倍ダブルチーズバーガー", price: 680, cal: 657 },
  { name: "倍チーズバーガー", price: 320, cal: 409 },
  { name: "倍チキチー", price: 380, cal: 593 },
  { name: "倍チキンフィレオ", price: 650, cal: 717 },
  { name: "倍ハンバーガー", price: 260, cal: 358 },
  { name: "倍ビッグマック", price: 700, cal: 723 },
  { name: "倍フィレオフィッシュ", price: 560, cal: 453 },
  { name: "倍ベーコンレタスバーガー", price: 600, cal: 467 },
  { name: "倍マックチキン", price: 350, cal: 542 },

  { name: "炙り醤油風 たまごベーコン肉厚ビーフ", price: 560, cal: 511 },
  { name: "炙り醤油風 ダブル肉厚ビーフ", price: 780, cal: 620 },
  { name: "チーズチーズてりやきマックバーガー", price: 520, cal: 578 },
  { name: "チーズチーズダブルチーズバーガー", price: 560, cal: 561 }

];


function pickCombo(budget) {
  const MAX_PER_ITEM = 3; // ← 同じ商品の最大数

  let best = [];
  let bestSum = 0;

  for (let trial = 0; trial < 40; trial++) {
    // 少しランダム性を混ぜた並び（高い順ベース）
    const shuffled = [...items].sort(() => (Math.random() - 0.5));
    shuffled.sort((a, b) => b.price - a.price + (Math.random() * 10 - 5));

    const combo = [];
    const counts = {}; // 商品名→個数
    let sum = 0;

    const canAdd = (it) => (counts[it.name] || 0) < MAX_PER_ITEM;
    const add = (it) => {
      combo.push(it);
      sum += it.price;
      counts[it.name] = (counts[it.name] || 0) + 1;
    };

    // まず高いのから入れていく
    for (const it of shuffled) {
      if (sum + it.price <= budget && canAdd(it)) {
        add(it);
      }
    }

    // 余りを「安い順」で埋める（ただし各商品MAX_PER_ITEM）
    const asc = [...items].sort((a, b) => a.price - b.price);
    let improved = true;
    while (improved) {
      improved = false;
      for (const it of asc) {
        if (sum + it.price <= budget && canAdd(it)) {
          add(it);
          improved = true; // もう一周してさらに埋める
        }
      }
    }

    if (sum > bestSum) {
  bestSum = sum;
  best = combo;
} else if (sum === bestSum && sum > 0) {
  // 同じ“良さ”の候補が複数あるなら、一定確率で入れ替えてランダム性を出す
  if (Math.random() < 0.35) best = combo;
}

  }

  return best;
}
function pickComboByCal(limitCal) {
  const MAX_PER_ITEM = 3;
  let best = [];
  let bestSum = 0;

  for (let trial = 0; trial < 40; trial++) {
    const shuffled = [...items].sort(() => Math.random() - 0.5);
    shuffled.sort((a, b) => (b.cal - a.cal) + (Math.random() * 10 - 5));

    const combo = [];
    const counts = {};
    let sumCal = 0;

    const canAdd = (it) => (counts[it.name] || 0) < MAX_PER_ITEM;
    const add = (it) => {
      combo.push(it);
      sumCal += it.cal;
      counts[it.name] = (counts[it.name] || 0) + 1;
    };

    for (const it of shuffled) {
      if (sumCal + it.cal <= limitCal && canAdd(it)) add(it);
    }

    const asc = [...items].sort((a, b) => a.cal - b.cal);
    let improved = true;
    while (improved) {
      improved = false;
      for (const it of asc) {
        if (sumCal + it.cal <= limitCal && canAdd(it)) {
          add(it);
          improved = true;
        }
      }
    }

    if (sumCal > bestSum) {
      bestSum = sumCal;
      best = combo;
      if (bestSum === limitCal) break;
    }
  }

  return best;
}

function render2(combo, mode, limit) {
  const sumPrice = combo.reduce((s, x) => s + x.price, 0);
  const sumCal = combo.reduce((s, x) => s + x.cal, 0);

  const head =
    mode === "price"
      ? `<div class="sum"><strong>合計：${sumPrice}円</strong><span class="badge">上限：${limit}円 / 参考：${sumCal}kcal</span></div>`
      : `<div class="sum"><strong>合計：${sumCal}kcal</strong><span class="badge">上限：${limit}kcal / 参考：${sumPrice}円</span></div>`;

  const itemsHtml = combo.length
    ? `<div class="items">` + combo.map(x => `
        <div class="item">
          <div class="name">${x.name}</div>
          <div class="meta">${x.price}円 / ${x.cal}kcal</div>
        </div>
      `).join("") + `</div>`
    : `<div class="hint">上限内で組めなかった…</div>`;

  return head + itemsHtml;
}



    function render(combo, budget) {
      const sum = combo.reduce((s, x) => s + x.price, 0);
      const lines = combo.map(x => `・${x.name}（${x.price}円）`).join("<br>");
      return `
        <div><b>合計：${sum}円 / 予算：${budget}円</b></div>
        <div style="margin-top:10px">${lines || "予算内で組めなかった…"} </div>
      `;
    }

document.getElementById("btn").addEventListener("click", () => {
  const mode = document.getElementById("mode").value; // "price" or "cal"
  const limit = Number(document.getElementById("limit").value || 0);

  const combo = (mode === "price")
    ? pickCombo(limit)
    : pickComboByCal(limit);

  document.getElementById("out").innerHTML = render2(combo, mode, limit);
});

  </script>
    </div>
</body>
</html>
